<div class="container pb-5 pt-3">
  <!-- HEADER AND TAB BAR -->
  <h3>ASWWU Senate Election</h3>
  <div class="">
    <div class="card-header navbar-nav-scroll scrollable">
      <ul class="nav nav-tabs no_change card-header-tabs flex-nowrap">
        <li class="nav-item" role="tablist">
          <a class="nav-link no_change" [ngClass]="{'active': pageNumber==0, 'disabled': pageNumber!=0}">Start</a>
        </li>
        <li class="nav-item" role="tablist">
          <a class="nav-link no_change" [ngClass]="{'active': pageNumber==1, 'disabled': pageNumber!=1}">1: Districts</a>
        </li>
        <li class="nav-item">
          <a class="nav-link no_change" [ngClass]="{'active': pageNumber==2, 'disabled': pageNumber!=2}">2: Senators</a>
        </li>
        <li class="nav-item">
          <a class="nav-link no_change" [ngClass]="{'active': pageNumber==3, 'disabled': pageNumber!=3}">Submit</a>
        </li>
      </ul>
    </div>
    <div *ngIf='!pageReady'>
      Loading...
    </div>

    <!-- START PAGE -->
    <div *ngIf='pageNumber == 0 && (pageReady)'>
      <div class="card-body">
        <h4>Welcome to the ASWWU Senate Elections!</h4>
        <p>
          Press <strong>Go!</strong> to begin voting for your district's senators.
        </p>
      </div>
      <div class="card-footer">
        <button type="button" (click)='nextPage();' class="btn btn-primary mx-auto w-100 d-block">Go!</button>
      </div>
    </div>

    <!-- SELECT DISTRICT PAGE -->
    <div *ngIf='pageNumber == 1'>
      <div class="card-body">
        <div *ngFor="let district of positionsList" class="btn-group-vertical btn-group-toggle col col-md-6 p-1" ngbRadioGroup name="district_input" [(ngModel)]="districtModel">
          <label ngbButtonLabel class="btn-outline-primary btn-nowrap text-left">
            <input ngbButton type="radio" value="{{district[0]}}">{{district[1]}}
          </label>
        </div>

      </div>
      <div class="card-footer">
        <button type="button" (click)='getCandidates();' class="btn btn-primary mx-auto w-100 d-block" [ngClass]="{'active': districtModel, 'disabled': !districtModel}">Go!</button>
      </div>
    </div>

    <!-- SELECT CANDIDATE PAGE -->
    <div *ngIf='pageNumber == 2'>
      <div class="card-body">
        <h4>{{positions[districtModel].position}} Senators</h4>
        <div class="row no-gutters">
          <!-- CANDIDATE CARD -->
          <div *ngFor="let candidate of candidates" class="col-6 col-md-4">
            <div class="card">
              <img class="card-img-top mx-auto d-block" src="{{candidate.photo || 'https://aswwu.com/media/img-sm/images/default_mask/default.jpg'}}" [ngClass]="{'disabled-photo': !enableVoting(candidate.username, true)}">
              <div class="card-footer btn-group-toggle">
                <label ngbButtonLabel class="btn btn-outline-primary btn-nowrap mx-auto w-100 d-block">
                  <input ngbButton type="checkbox" [ngModel]="candidateModel[candidate.username]" (ngModelChange)="valueChange($event, candidate.username)" [disabled]='!enableVoting(candidate.username, true)'>
                  {{candidate.display_name}}
                </label>
              </div>
            </div>
          </div>
        </div>
        <hr>

        <div class="input-group row mx-auto">
          <div class="col-md-6 p-1"><input type="text" class="form-control" [(ngModel)]="writeInModel.writeIn1" [disabled]='!enableVoting(writeInModel.writeIn1, false)' [ngbTypeahead]="search" editable placeholder="Write In Candidate" /></div>
          <div class="col-md-6 p-1"><input type="text" class="form-control" [(ngModel)]="writeInModel.writeIn2" [disabled]='!enableVoting(writeInModel.writeIn2, false)' [ngbTypeahead]="search" editable placeholder="Write In Candidate" /></div>
        </div>
        <hr>
      </div>

      <div class="card-footer">
        <div class="row">
          <div class="col-md-9 order-md-2 p-1"><button type="button" (click)='submit();' class="btn btn-primary mx-auto w-100 d-block">Vote!</button></div>
          <div class="col-md-3 order-md-1 p-1"><button type="button" (click)='ngOnInit();' class="btn btn-danger mx-auto w-100 d-block">Start Over</button></div>
        </div>
      </div>
    </div>

    <!-- SUBMISSION PAGE -->
    <div *ngIf='pageNumber == 3'>
      <div class="card-body">
        <span *ngIf="submissionSuccess == null" class="submissionStatus"> Waiting... ðŸ¤” </span>
        <span *ngIf="submissionSuccess" class="submissionStatus"> Thanks for participating in Democracy! ðŸ¤— </span>
        <span *ngIf="(submissionSuccess != null) && !submissionSuccess" class="submissionStatus">FAILED! ðŸ˜­ <br>Please contact an ASWWU representative.</span>
      </div>
      <div class="card-footer">
        <div class="row">
          <div class="col-md-3 order-md-1 p-1"><button type="button" (click)='ngOnInit();' class="btn btn-danger mx-auto w-100 d-block">Start Over</button></div>
          <div class="col-md-3 order-md-1 p-1"><button type="button" onclick="window.location.href = 'https://aswwu.com';" class="btn btn-primary mx-auto w-100 d-block">Return to aswwu.com</button></div>
        </div>
      </div>
    </div>
  </div>
</div>
